{% extends 'header.html' %}
{% load static %}
{% block title %}제품 정보 요청 엑셀{% endblock %}

{% block head %}
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet"/>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet@2.1.13/dist/plugins/css/pluginsCss.css"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet@2.1.13/dist/plugins/plugins.css"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet@2.1.13/dist/css/luckysheet.css"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet@2.1.13/dist/assets/iconfont/iconfont.css"/>
<script src="https://cdn.jsdelivr.net/npm/luckysheet@2.1.13/dist/plugins/js/plugin.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/luckysheet@2.1.13/dist/luckysheet.umd.js" defer></script>

<script src="https://cdn.jsdelivr.net/npm/luckyexcel@1.0.1/dist/luckyexcel.umd.js" defer></script>

<link rel="stylesheet" href="{% static 'css/certy/prdinfo.css' %}"/>
<link rel="stylesheet" href="{% static 'css/certy/prdinfo_tab.css' %}"/>
<link rel="stylesheet" href="{% static 'css/helpbtn.css' %}"/>

<script src="{% static 'scripts/certy/prdinfo_tab.js' %}" defer></script>
<script src="{% static 'scripts/certy/prdinfo_Luckysheet.js' %}" defer></script>
<script src="{% static 'scripts/certy/prdinfo_upload.js' %}" defer></script>
<script src="{% static 'scripts/certy/prdinfo_generate.js' %}" defer></script>
<script src="{% static 'scripts/certy/prdinfo_fill_cells.js' %}" defer></script>
<script src="{% static 'scripts/certy/prdinfo_download.js' %}" defer></script>
{% endblock %}

{% block content %}
<div class="app-container">
  <div class="main-content">
    <div class="sidebar-container">
      <div class="search-title">
        <i class="fas fa-search search-icon"></i> 제품 정보 요청 자동 작성
        <span class="tooltip">ⓘ
          <span class="tooltiptext upload">시험성적서, 시험합의서, 결함리포트 파일을 업로드 하시면<br/>제품 정보 요청 엑셀 파일을 만들어 드립니다.</span>
        </span>
      </div>
      <div class="sidebar">
        <form id="queryForm" method="post" enctype="multipart/form-data">
          {% csrf_token %}
          <div class="file-upload-container">
            <div class="content-container" id="content-auto">
              <input class="file-input" id="fileInput" type="file" name="file" multiple accept=".pdf,.docx,.xlsx"/>

              <div class="drop-area" id="dropArea">
                <i class="fas fa-cloud-upload-alt text-3xl text-blue-400"></i>
                <p>파일을 이곳에 드래그하거나</p>
                <p><span class="text-blue-500 font-medium">클릭</span>하여 업로드하세요</p>
                <p class="upload-limit-message">* pdf, docx, xlsx 파일을 업로드 해주세요.<br/>(최대 3개)</p>
              </div>

              <div class="file-list hidden" id="fileList"></div>

              <div class="content-spacer"></div>
              <button type="button" class="action-button" id="btn-generate">제품 정보 요청 엑셀 파일 생성</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="content-card">
    <div class="loading-container hidden" id="loadingContainer">
      <div class="spinner"></div>
      <div class="loading-text">분석 중...</div>
      <div class="loading-description">제품 정보 요청 엑셀 파일을 생성하고 있습니다.</div>
    </div>
    <div class="results-container">
      <div class="results-header">
        <div class="results-title">
          <div class="results-title">제품 정보 요청 엑셀 파일</div>
          <span class="tooltip">ⓘ
            <span class="tooltiptext result">처음 자동 입력 시에는 한줄로 보이지만<br/>엑셀로 다운로드하시면 여러 줄로 작성됩니다.<br/>(회사명, 제품명 등 2줄 이상 작성되는 값들)</span>
          </span>
        </div>
        <button type="button" class="action-button download" id="btn-download">다운로드</button>
      </div>
        
      <div class="main-tab-container">
        <div class="main-tab active" data-tab="preInput">사전 입력 사항</div>
        <div class="main-tab" data-tab="resultSheet">결과 시트</div>
      </div>

      <div class="tab-content active" id="preInputContent">
        <div class="input-form-container">
          <div class="form-section">
            <div class="form-item">
                <div class="form-input-group">
                    <label class="form-label">SW 분류</label>
                    <select class="form-select" id="swClassification">
                        <option>유틸리티 SW-압축</option>
                        <option>유틸리티 SW-웹브라우저</option>
                        <option>유틸리티 SW-원격제어</option>
                        <option>유틸리티 SW-메신저</option>
                        <option>유틸리티 SW-리포팅</option>
                        <option>유틸리티 SW-언어 번역</option>
                        <option>유틸리티 SW-데이터영구삭제</option>
                        <option>유틸리티 SW-데이터백업/복구</option>
                        <option>유틸리티 SW-화상회의</option>
                        <option>유틸리티 SW-문서회의</option>
                        <option>유틸리티 SW-FTP</option>
                        <option>유틸리티 SW-PDF변환</option>
                        <option>유틸리티 SW-형상관리</option>
                        <option>유틸리티 SW-이미지뷰어</option>
                        <option>유틸리티 SW-가상CD드라이브</option>
                        <option>유틸리티 SW-메타데이터 관리</option>
                        <option>유틸리티 SW-기타</option>
                        <option>보안용 SW-PC보안</option>
                        <option>보안용 SW-DB보안</option>
                        <option>보안용 SW-서버보안</option>
                        <option>보안용 SW-웹보안</option>
                        <option>보안용 SW-키보드보안</option>
                        <option>보안용 SW-침입차단(방화벽)</option>
                        <option>보안용 SW-침입탐지(IDS)</option>
                        <option>보안용 SW-스팸및악성코드차단</option>
                        <option>보안용 SW-바이러스백신</option>
                        <option>보안용 SW-인증관리(PKI,SSO)</option>
                        <option>보안용 SW-디지털콘텐츠보안</option>
                        <option>보안용 SW-통합보안관리(ESM)</option>
                        <option>보안용 SW-기타</option>
                        <option>기업용 SW-그룹웨어(Groupware)</option>
                        <option>기업용 SW-비즈니스관리(BPM)</option>
                        <option>기업용 SW-전사적자원관리(ERP)</option>
                        <option>기업용 SW-고객관계관리(CRM)</option>
                        <option>기업용 SW-공급망관리(SCM)</option>
                        <option>기업용 SW-기업포털(EIP)</option>
                        <option>기업용 SW-지식관리(KMS)</option>
                        <option>기업용 SW-경영정보관리(MIS)</option>
                        <option>기업용 SW-인적자원관리(HR)</option>
                        <option>기업용 SW-프로젝트관리(PMS)</option>
                        <option>기업용 SW-회계관리</option>
                        <option>기업용 SW-고객상담지원</option>
                        <option>기업용 SW-자동차운전학원관리</option>
                        <option>기업용 SW-기타</option>
                        <option>디지털콘텐츠 SW-웹페이지저작</option>
                        <option>디지털콘텐츠 SW-멀티미디어저작</option>
                        <option>디지털콘텐츠 SW-디지털콘텐츠관리(CMS)</option>
                        <option>디지털콘텐츠 SW-디지털음성처리</option>
                        <option>디지털콘텐츠 SW-전자출판</option>
                        <option>디지털콘텐츠 SW-그래픽편집</option>
                        <option>디지털콘텐츠 SW-CAD/CAM</option>
                        <option>디지털콘텐츠 SW-기타</option>
                        <option>임베디드 SW-RFID</option>
                        <option>임베디드 SW-Zigbee</option>
                        <option>임베디드 SW-공정제어</option>
                        <option>임베디드 SW-의료장비용</option>
                        <option>임베디드 SW-방송장비용</option>
                        <option>임베디드 SW-임베디드용</option>
                        <option>임베디드 SW-교통및주차관리</option>
                        <option>임베디드 SW-기타</option>
                        <option>시스템관리 SW-시스템 관리(SMS)</option>
                        <option>시스템관리 SW-네트워크 관리(NMS)</option>
                        <option>시스템관리 SW-스토리지 관리</option>
                        <option>시스템관리 SW-성능 측정 및 관리</option>
                        <option>시스템관리 SW-패치 관리(PMS)</option>
                        <option>시스템관리 SW-통합 관리(EMS)</option>
                        <option>시스템관리 SW-PC 관리</option>
                        <option>시스템관리 SW-홈네트워크</option>
                        <option>시스템관리 SW-텔레매틱스</option>
                        <option>시스템관리 SW-감시장비제어</option>
                        <option>시스템관리 SW-기타</option>
                        <option>미들웨어 SW-WAS</option>
                        <option>미들웨어 SW-검색엔진</option>
                        <option>미들웨어 SW-이동단말기</option>
                        <option>미들웨어 SW-전사적애플리케이션통합(EAI)</option>
                        <option>미들웨어 SW-기타</option>
                        <option>바이오매트릭스 SW-지문 인식</option>
                        <option>바이오매트릭스 SW-음성 인식</option>
                        <option>바이오매트릭스 SW-홍체 인식</option>
                        <option>바이오매트릭스 SW-얼굴 인식</option>
                        <option>바이오매트릭스 SW-기타</option>
                        <option>사무용 SW-프리젠테이션</option>
                        <option>사무용 SW-워드프로세서</option>
                        <option>사무용 SW-스프레드쉬트</option>
                        <option>사무용 SW-오피스</option>
                        <option>사무용 SW-문서 뷰어</option>
                        <option>사무용 SW-기타</option>
                        <option>운영체제 SW-윈도우즈 운영체제</option>
                        <option>운영체제 SW-유닉스 운영체제</option>
                        <option>운영체제 SW-리눅스 운영체제</option>
                        <option>운영체제 SW-임베디드 운영체제</option>
                        <option>운영체제 SW-기타</option>
                        <option>웹서비스용 SW-웹메일</option>
                        <option>웹서비스용 SW-웹하드</option>
                        <option>웹서비스용 SW-웹포털</option>
                        <option>웹서비스용 SW-웹서버</option>
                        <option>웹서비스용 SW-단문자발송(SMS)</option>
                        <option>웹서비스용 SW-기타</option>
                        <option>게임용 SW-모바일 게임</option>
                        <option>게임용 SW-온라인 게임</option>
                        <option>게임용 SW-아케이드 게임</option>
                        <option>게임용 SW-비디오 게임</option>
                        <option>게임용 SW-PC패키지 게임</option>
                        <option>게임용 SW-기타</option>
                        <option>데이터베이스 SW-DBMS</option>
                        <option>데이터베이스 SW-DB관리</option>
                        <option>데이터베이스 SW-DB리포팅</option>
                        <option>데이터베이스 SW-기타</option>
                        <option>프로그램개발 관련 SW-프로그램개발지원</option>
                        <option>프로그램개발 관련 SW-시험도구</option>
                        <option>프로그램개발 관련 SW-소스코드분석</option>
                        <option>프로그램개발 관련 SW-모델링도구</option>
                        <option>프로그램개발 관련 SW-기타</option>
                        <option>GIS SW-상하수도시설물관리</option>
                        <option>GIS SW-도로시설물관리</option>
                        <option>GIS SW-도로및상하수도시설물관리</option>
                        <option>GIS SW-기타</option>
                        <option>주문형(SI) SW-주문형(SI)</option>
                        <option>교육용 SW-온라인(e-learning)교수학습</option>
                        <option>교육용 SW-오프라인교수학습</option>
                        <option>교육용 SW-교수학습지원</option>
                        <option>교육용 SW-기타</option>
                    </select>
                </div>
            </div>
          </div>
          
          <div class="form-section">
            <div class="form-item">
              <div class="form-input-group">
                <label class="form-label">클라우드 환경 구성</label>
                <div class="radio-group">
                  <div class="radio-item">
                    <input type="radio" id="cloud_yes" name="cloud_config" value="yes">
                    <label for="cloud_yes">O</label>
                  </div>
                  <div class="radio-item">
                    <input type="radio" id="cloud_no" name="cloud_config" value="no" checked>
                    <label for="cloud_no">X</label>
                  </div>
                </div>
              </div>
                
              <div class="sub-section hidden-section" id="cloudEnvironmentSection">
                <div class="sub-label">시험환경</div>
                <textarea class="form-textarea" id="testEnvironment" placeholder="예: 모니터링 서버가 AWS 환경으로 구성됨"></textarea>
              </div>
            </div>
          </div>

          <div class="form-section">
            <div class="form-item">
              <div class="form-input-group">
                <label class="form-label">SaaS형 제품</label>
                <div class="radio-group">
                  <div class="radio-item">
                    <input type="radio" id="saas_yes" name="saas_config" value="yes">
                    <label for="saas_yes">O</label>
                  </div>
                  <div class="radio-item">
                    <input type="radio" id="saas_no" name="saas_config" value="no" checked>
                    <label for="saas_no">X</label>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-section">
            <div class="form-item">
              <div class="form-input-group">
                <label class="form-label">재계약 여부</label>
                <div class="radio-group">
                  <div class="radio-item">
                    <input type="radio" id="recontract_yes" name="recontract_status" value="yes">
                    <label for="recontract_yes">O</label>
                  </div>
                  <div class="radio-item">
                    <input type="radio" id="recontract_no" name="recontract_status" value="no" checked>
                    <label for="recontract_no">X</label>
                  </div>
                </div>
              </div>
              <div class="sub-section hidden-section" id="recontractSection">
                <div class="sub-label">기존 시험 신청 번호</div>
                <textarea class="form-textarea" id="recontractNumber"></textarea>
              </div>
            </div>
          </div>
          <div class="form-section">
            <div class="form-item">
              <div class="form-input-group">
                <label class="form-label">재인증 구분</label>
                <select class="form-select" id="reCertType">
                  <option value="해당사항 없음">해당사항 없음</option>
                  <option value="간소화 재인증(품질 개선)">간소화 재인증(품질 개선)</option>
                  <option value="간소화 재인증(부분 변경)">간소화 재인증(부분 변경)</option>
                  <option value="중요 변경 재인증">중요 변경 재인증</option>
                </select>
              </div>

              <div class="sub-section hidden-section" id="reCertSection">
                  <div class="sub-label-group">
                      <div class="sub-label">기존 인증 제품 번호</div>
                      <button type="button" class="action-button action-button-small" id="btnLookupCert">조회</button>
                  </div>
                  <input type="text" class="form-input" id="reCertNumberInput" placeholder="GS-X-XX-XXXX를 입력하세요.">
                  <textarea class="form-textarea single-line hidden-section" id="reCertResultText" rows="1"></textarea>
              </div>
            </div>
          </div>

          <div class="form-section">
            <div class="form-item">
                <div class="form-input-group" style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">
                    <label class="form-label" style="min-width: 110px;">시험원</label>
                    <textarea type="text" id="tester" class="form-textarea" placeholder="XXX, XXX" rows="1"></textarea>
                </div>
            </div>
          </div>
          <div class="form-section">
            <div class="form-item">
              <div class="form-input-group">
                <label class="form-label">보안성 시험 면제 여부</label>
                <div class="radio-group">
                  <div class="radio-item">
                    <input type="radio" id="security_yes" name="security_config" value="yes">
                    <label for="security_yes">O</label>
                  </div>
                  <div class="radio-item">
                    <input type="radio" id="security_no" name="security_config" value="no" checked>
                    <label for="security_no">X</label>
                  </div>
                </div>
              </div>
                
              <div class="sub-section hidden-section" id="securitySection1">
                <div class="sub-label">보안 인증 종류</div>
                <textarea class="form-textarea" id="security1"></textarea>
              </div>
              <div class="sub-section hidden-section" id="securitySection2">
                <div class="sub-label">인증번호</div>
                <textarea class="form-textarea" id="security2"></textarea>
              </div>
              <div class="sub-section hidden-section" id="securitySection3">
                <div class="sub-label">인증일</div>
                <textarea class="form-textarea" id="security3"></textarea>
              </div>
            </div>
          </div>

        </div>
      </div>

      <div class="tab-content" id="resultSheetContent">
        <div id="luckysheetContainer" style="width:100%;min-height:600px;height:80vh;"></div>
      </div>

    </div>
  </div>
</div>
{% endblock %}
